"use strict";geotab.addin.ioxOutput=function(){var o,i,d,u,a,c,l,r=function(e){c.innerHTML=e},n=function(e){var t=e+"-"+Date.now(),n=document.createElement("h4"),i=document.createTextNode("Sent: "+new Date);n.setAttribute("id",t),n.appendChild(i),a.appendChild(n),function t(n){setTimeout(function(){o.call("Get",{typeName:"TextMessage",search:{id:n.split("-")[0]}},function(e){e[0].delivered?document.getElementById(n).innerHTML+=", Delivered: "+new Date(e[0].delivered):t(n)},r)},1e3)}(t)},s=function(){var e=d.value,t=l.options[l.selectedIndex].text;o.call("Add",{typeName:"TextMessage",entity:{device:{id:e},messageContent:{isRelayOn:"On"===t,contentType:"IoxOutput"},isDirectionToVehicle:!0}},n,r)},m=function(e,t){return(e=e.name.toLowerCase())===(t=t.name.toLowerCase())?0:t<e?1:-1};return{initialize:function(e,t,n){o=e,i=document.getElementById("ioxoutput"),d=document.getElementById("ioxoutput-vehicles"),u=document.getElementById("ioxoutput-send"),a=document.getElementById("ioxoutput-history"),c=document.getElementById("ioxoutput-error"),l=document.getElementById("ioxoutput-state"),d.addEventListener("change",function(){u.disabled=!1}),u.addEventListener("click",s),n()},focus:function(e){(o=e).call("Get",{typeName:"Device",resultsLimit:1e3,search:{fromDate:(new Date).toISOString()}},function(e){if(e&&!(e.length<1)){e.sort(m),d.innerHTML="";for(var t=0;t<e.length;t++){var n=new Option;n.text=e[t].name,n.value=e[t].id,d.add(n)}u.disabled=!1,i.style.display=""}},r)},blur:function(){u.disabled=!0,i.style.display="none"}}};